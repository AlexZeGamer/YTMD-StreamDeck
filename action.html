<!DOCTYPE html>
<html lang="en">
<head>
	<title>YouTube Music Desktop Connector</title>
	<meta charset="utf-8">
	<link rel="stylesheet" href="sdpi.css">
	<script src="js/libs/easy-streamdeck-v2.0.1.js"></script>
</head>
<body>
<div class="sdpi-wrapper" id="mainSettings">
	<div class="sdpi-item">
		<div class="sdpi-item-label">Host</div>
		<input class="sdpi-item-value" type="text" id="host">
	</div>
	<div class="sdpi-item">
		<div class="sdpi-item-label">Port</div>
		<input class="sdpi-item-value" type="number" id="port">
	</div>
	<div class="sdpi-item">
		<div class="sdpi-item-label">Password</div>
		<input class="sdpi-item-value" type="password" id="password">
	</div>
	<div class="sdpi-item">
		<button class="sdpi-item-value" id="save">Save</button>
	</div>
</div>

<script>

    streamdeck.on('ready', function () {
        if (this.actionId !== 'fun.shiro.ytmdc.play-pause') {
            document.getElementById('mainSettings').remove();
            return;
        }

        function updateValue(newSettings) {
            streamdeck.setSettings(newSettings);
        }

        const host = document.getElementById('host'),
            port = document.getElementById('port'),
            password = document.getElementById('password'),
            save = document.getElementById('save');

        streamdeck.getSettings().then(res => {
            const {hostData, portData, passwordData} = res;
            host.value = hostData || 'localhost';
            port.value = portData || 9863;
            password.value = passwordData || '';

        }).catch(err => {
            console.error(err);
        });

        save.onclick = () => {
            const hostData = host.value;
            const portData = port.value;
            const passwordData = password.value;
            updateValue({hostData, portData, passwordData});
        }
    });
</script>
</body>
</html>
